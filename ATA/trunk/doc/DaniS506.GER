
		      Daniela's S506 ADD - Release 1.8.5
		      ----------------------------------


  Deutsche öbersetzung von Klaus Kulbarsch Fidonet 2:2426/1205

  Diese öbersetzung habe ich angefertigt, um vielen, die Probleme mit der
  englischen Sprache haben, den Einsatz dieses vorzÅglichen Treibers zu
  erleichtern. Ich habe mich bei der öbersetzung darum bemÅht, mich nicht
  sklavisch an den Text des Originals zu halten, sondern sinngemÑ· zu
  Åbersetzen, ohne die *eigentlichen* Informationen zu verfÑlschen. Hin und
  wieder habe ich zusÑtzliche Anmerkungen hineingebracht - sie sind immer in
  Klammern gesetzt und am Ende mit -KK gekennzeichnet.

  Dennoch sind Fehler niemals auszuschlie·en, zumal mir nicht eine so fundierte
  Kenntnis der zugrundeliegenden Hardware gegeben ist, wie sie Daniela
  zweifelsohne hat. Deswegen gilt hier in besonderem Ma·e:

  GöLTIG  IST AUSSCHLIESSLICH DAS ENGLISCHE ORIGINAL VON DANIELA. IN
  ZWEIFELSFéLLEN BITTE IMMER AUF DIESES ZURöCKGREIFEN: DANIELA HAT DIESEN
  TREIBER ENTWICKELT UND NUR IHRE AUSFöHRUNGEN SIND MA·GEBEND.


NAME
     DaniS506.ADD   -  Ersatz fÅr den IBM-Treiber IBM1S506.ADD

ZUSAMMENFASSUNG
     EIDE-Treiber mit UnterstÅtzung fÅr Intel, VIA, ALi, SiS, CMD, Promise,
     Cyrix, HighPoint, AMD, Artop, SMSC, ServerWorks, Opti, Nvidia, National
     Semiconductor, SiliconImage, ITE, Adaptec, ATI, Broadcom, JMicron, Marvell
     ChipsÑtze sowie grundsÑtzliche Busmaster-UnterstÅtzung fÅr alle SFF-8038i
     kompatiblen Chips.

     Damit ist nahezu *jeder* EIDE-Controller abgedeckt, der in den letzten
     Jahren gebaut bzw. verkauft wurde und darÅber hinaus sogar einige, die
     in der nahen Zukunft erst auf den Markt kommen werden. Bitte nicht wegen
     Gattungsnamen der unten erwÑhnten ChipsÑtze durcheinanderkommen. Wenn Du
     nicht sicher bist, ob Dein aktueller Controller unterstÅtzt wird, dann
     lasse einfach das DumpIDE-Programm laufen - es wird es Dir sagen.

###  Hinweis:
###  Dieser Treiber ist *nicht* kompatibel mit irgendeiner der Software-RAID
###  Implementierungen die von den sogenannten IDE RAID Controllern (z.B. HPT,
###  Promise FastTrack, AMI, Via, Intel, SiS, oder andere) angeboten werden.
###  Keiner dieser "Pseudo-RAIDs" hat irgendwelche Hardware RAID-Funktionen
###  eingebaut!
###  SelbstverstÑndlich sind diese Chips mit nicht-RAID BIOS-Einstellungen zu
###  betreiben (d.h. JBOD).

***  énderungen gegenÅber der vorhergehenden Version sind mit "***" markiert.

BESCHREIBUNG
     Da der originale IBM1S506.ADD den IDE-Controller in der VIA 82C586(/A/B)
     Southbridge nur in den grundlegendsten Funktionen unterstÅtzt und
     nichts darÅber hinaus, war ich nicht besonders glÅcklich mit der
     LeistungsfÑhigkeit meiner 10 GB DTTA-351010 Festplatte. Der Treiber von
     VIA selber war keine Lîsung, weil er all die fortgeschrittenen
     Mîglichkeiten moderner Hardware nicht unterstÅtzt und darÅber hinaus
     mein System komplett aufhing. Also habe ich mich hingesetzt ...

     Diese Version meines S506 Treibers basiert nicht mehr auf dem
     Quellcode, wie er auf IBMs DDK-Seiten vorgehalten wird. Er enthÑlt die
     neuesten FÑhigkeiten, wie sie in den aktuellen Fixpacks enthalten sind
     bzw. in jÅngeren Einzelfixes hinzugekommen sind.

     Meine Erweiterungen sind folgende:

     - (unterstÅtzt den Intel PIIX, genau  wie der IBM1S506 es tut) plus
       einiger PIIX4 Varianten, die von IBM1S506 nicht unterstÅtzt sind.
     - unterstÅtzt die Intel ICH/ICH0/ICH2/ICH3/ICH4/C-ICH/ICH5/ICH6/ICH7/ICH8
       PATA Controller
     - unterstÅtzt die Intel ICH5/ICH6/ICH7/ICH8/ICH9/ICH10 SATA Controller
     - unterstÅtzt die Intel Management Engine IDE Redirection Controller
***  - unterstÅtzt den Intel SCH PATA Controller ("Atom") (experimentell)
     - unterstÅtzt die VIA PATA Controller
     - unterstÅtzt die VIA PATA/SATA RAID Controller (siehe Hinweis ###)
     - unterstÅtzt die ALi PATA Controller
     - unterstÅtzt die ALi 5281/5287/5289 PATA/SATA RAID Controller (siehe Hinweis ###)
     - unterstÅtzt die SiS 5513/5517/5518/180 PATA Controller
     - unterstÅtzt die SiS 180/181/182/1180/1182/1183/1184 (ab 182 experimentell)
       SATA RAID Controllers (siehe Hinweis ###)
     - unterstÅtzt die CMD 643/646/648/649 PATA Controller
       (das schlie·t OEMs wie AMI ein)
     - unterstÅtzt die Promise Ultra33/66/100/TX2/133 PATA Controller
     - unterstÅtzt den Cyrix 5530 PATA controller (Cyrix MediaGX)
     - unterstÅtzt die HighPoint HPT302/366/368/370/371/372/374 PATA Controller
     - unterstÅtzt die AMD756/766/768/8111/GeodeLX PATA Controller
     - unterstÅtzt die ACARD ATP850/860/865/867 PATA Controller (ATP860 exp.)
     - unterstÅtzt den SMSC SLC90E66 PATA Controller (Ñhnlich PIIX4) (exp.)
     - unterstÅtzt die ServerWorks/Broadcom PATA Controller
     - unterstÅtzt die Opti PATA Controller
     - unterstÅtzt die Nvidia nForce/2/3/4/500/600/700 PATA Controller
       wichtiger Fix fÅr defekte BIOSse, die zum Systemstillstand fÅhren kînnen
     - unterstÅtzt die Nvidia nForce2s/3/4/500/600/700 SATA Controller
     - unterstÅtzt den National Semiconductor Geode SCx200 PATA Controller
     - unterstÅtzt den Silicon Image 680 PATA Controller
     - unterstÅtzt den Silicon Image 3112/3114/3512 SATA Controller
       (das schlie·t OEMs wie Adaptec ein)(SiI3114: alle 4 Ports, aber kein SATAPI)
     - unterstÅtzt den ITE 8211/8212 PATA RAID Controller (siehe Hinweis ###)
     - unterstÅtzt die ATI IXP200/300/400/600/700 PATA Controller
     - unterstÅtzt die ATI IXP300/400/600/700/800 SATA Controller
     - unterstÅtzt die NetCell/Revolution SyncRAID PATA/SATA Hardware-RAID
       Controller
     - unterstÅtzt die JMicron JMB360/361/363/365/366/368 PATA/SATA Contoller
     - unterstÅtzt die Marvell 641x PATA Controller (experimentell)
     - allgemeine BusmasterunterstÅtzung fÅr SFF-8038i kompatible Controller
     - unterstÅtzt SATA <-> PATA Adapter
     - unterstÅtzt SATA/SATAPI Hotplugging
     - unterstÅtzt PCCard (frÅher: PCMCIA) ATA/ATAPI Controller.
     - unterstÅtzt ATA-Flash, Compact-Flash, CF+, SmartMedia, etc. in PCCard-
       SchÑchten
     - unterstÅtzt interne DriveBays
     - unterstÅtzt den externen DriveBay und andere Åber PCCards angeschlossene
       GerÑte
     - keine Notwendigkeit mehr fÅr eine Initialisierung durch das BIOS
       betrifft Intel, VIA, ALi, SiS, CMD, Promise, und HighPoint
     - UnterstÅtzung der Ultra33/66/100/133 DMA Modi entsprechend der
       Chip-Feature-Matrix (ChipList.txt)
     - UnterstÅtzung der 1.5GBit/s and 3.0 GBit/s SATA Modi entsprechend der
       Chip-Feature-Matrix (ChipList.txt)
     - schnellerer PIO-Modus dank 32-Bit I/O-Routinen
     - einstellbares Power-Management fÅr Festplatten (gerÑteseitiges APM)
     - einstellbares Power-Management fÅr SATA-Verbindungen
     - setzt InaktivitÑtstimer der entsprechenden GerÑte (POWERSV.SYS wird
       nicht mehr benîtigt)
     - einstellbare SMS LÑnge
     - einstellbares LaufwerksgerÑusch
     - optionaler Schreibschutz der ersten Spur eines Plattenlaufwerks
     - schaltet die gesamte KapazitÑt von Platten frei, die zwecks
       KompatibilitÑt mit Ñlteren BIOSen umprogrammiert wurden, eine kleinere
       KapazitÑt zu melden
     - verbesserter Support fÅr Wechselmedien-GerÑte (inbesondere
       Castlewood ORB EIDE und das Fujitsu M2541B MO Laufwerk)
     - unterstÅtzt GerÑte, die nicht automatisch hochdrehen
     - optional kann die DatenÅbertragungsrate limitiert werden um verlÑss-
       licheres Arbeiten zu gewÑhrleisten
     - pa·t (Funktion entfernt: auch automatisch) das Chiptiming dem PCI-Takt an
     - kann mit Platten bis 2 TiB umgehen (das OS/2 ADD-Limit)
       bis jetzt mit Laufwerken bis zu 2 TiB Grî·e getestet
     - verbesserte BIOS-KompatibilitÑt (IBM1S506.ADD bootet nicht mit einer
       steigenden Anzahl von neuen BIOS-Implementierungen).
     - einige zusÑtzliche optionale Leitungsfeatures
     - bis zu 16 PATA/SATA-KanÑle
     - verbesserte UnterstÅzung fÅr S.M.A.R.T.
     - verbesserte StabilitÑt im Falle von SATA PHY Kommunikationsproblemen
     - einige Fehlerberichtigungen fÅr Bugs aus frÅheren Versionen
     - einige Berichtigungen fÅr Fehler und NachlÑssigkeiten im IBM-Code ;-)
     - umgeht einige BIOS Probleme mit Laufwerksgeometrien
     - Fix zur Behebung der mîglichen DatenverfÑlschung bei manchen VIA Chips.
     - Fix fÅr einen HÑnger bei der Initialisierung einiger GerÑte, die
       nach einzelnen Kommandos einige Zeit nicht angesprochen werden dÅrfen.
     - unterstÅtzt "hohe" Interrupts (IRQ16 und hîher) im APIC Interruptmodus.
       dazu wird ACPI.PSD v3 oder neuer benîtigt!

###  Achtung: Wer DaniBoot v1.0 benutzt mu· auf Version 1.0.2 umstellen!
###  Achtung: Wer DaniATAPI v0.3.x benutzt mu· auf Version 0.4.0 umstellen!
###  Achtung: Andere ATAPI-Filtertreiber funtionieren nicht mehr wegen unum-
	      gÑnglicher énderungen in der Inter-Treiber-Kommunikation!


KOMMANDOZEILENPARAMETER
     Dieser Treiber unterstÅtzt die meisten Schalter und Optionen die auch der
     IBM1S506 unterstÅtzt. Eine ErklÑrung fÅr diese findet man in der OS/2
     Online-Hilfe ('OS/2 Kommandos nach Namen sortiert' / ' BASEDEV...'/'IDE)

KOMMANDOZEILENPARAMETER öBERSICHT
     Gerald Eischer hat uns den Gefallen getan, ein Syntax Diagramm und eine
     kurze öbersicht der implementierten Optionen zu erstellen.

***  Syntax Diagram
     --------------

			   +------------------+ +-- /I --+  +---------------+
			   V		      | V	 |  V		    |
     BASEDEV=DaniS506.ADD --+----------------++-- /A:nn -+---+-------------++->
			    +-+- /!V -+------+	^	     +- /P:hhh ----+
			    | +- /!W -+      |	|	     +- /IRQ:n ----+
			    +--- /!AA -------+	+--------+   +- /!BM ------+
			    +--- /PCLK:x ----+		 |   +- /FORCEGBM -+
			    +-+- /GBM -----+-+		 |   +- /PF:xxxx --+
			    | +- /FORCEGBM + |		 |   +- /80WIRE ---+
			    +--- /SHUTDOWN --+		 |   +- /TO:nn ----+
			    +--- /DEBUG:n ---+		 |   +- /BAY ------+
			    +--- /!BIOS -----+		 |   +- /IT:x -----+
			    +--- /PCS:n -----+		 |   +- /LOC:spec -+
			    +--- /!BM -------+		 |   +--- /APM:n --+
			    +--- /PF:xxxx ---+		 |   +--- /LPM:n --+
			    +--- /IT:x ------+		 |
			    +--- /APM:n -----+		 |
			    +--- /LPM:n -----+		 |
							 |
       >--------+----------------------------------------+------------------|
		|				       ^
		| +----------------------------------+ |
		| +--/I---+ +----------------------+ | |
		| V	  | V			   | | |
		+-+- /U:n +--+-------------------+-+-+-+
			     +- /T:n ------------+
			     +- /!SMS -----------+
			     +- /!DM ------------+
			     +- /IT:x -----------+
			     +- /MR:udp ---------+
			     +- /PF:xxxx --------+
			     +- /NL:n -----------+
			     +- /!SETMAX --------+
			     +- /WP:x -----------+
			     +- /!BM ------------+
			     +--- /APM:n --------+
			     +--- /LPM:n --------+


     In den meisten FÑllen kînnen Optionen mit einem vorangestellten '!'
     mittels des '!' dazu genutzt werden, die entsprechende Option explizit
     abzuschalten. Solche Optionen sind dann sowohl ohne als auch mit dem '!'
     gÅltig.

     Die Werte in den Klammern entsprechen den Default-Werten der jeweiligen
     Optionen, die dann gelten, wenn diesee Optionen nicht angegeben sind.

     Optionen dÅrfen anstatt mit '/' auch mit '-' eingeleitet werden.


     Allgemeine Optionen
     -------------------

     /!V /VL /VLL					    (still)
	(kein) Quasselmodus (wenig/weniger detailliert)
     /!W /WL /WLL					    (still)
	wie /!V, aber hÑlt Ausgaben an
     /!AA						    (Warntîne)
	Keine Warntîne
     /PCLK:x						    (33MHz)
	PCI Takt (DECIMAL)
     /GBM						    (aus)
	Generic Busmaster Mode
     /FORCEGBM						    (aus)
	Force Generic Busmaster mode
     /!SHUTDOWN 					    (kein)
	(kein) Shutdown jedes angeschlossenen GerÑtes
     /DEBUG:n						    (0)
	Setze Debug Stufe (DECIMAL)
     /!BIOS						    (nutze BIOS
	keinerlei BIOS Int13 Aufrufe			       falls nîtig)
     /PCS						    (0)
	UnterstÅtze alle gefundenen PCCard Slots
     /PCS:n						    (0)
	UnterstÅtze maximal n PCCard Slots
     /!BM						    (ATA  : ja)
	(nicht) BusMaster DMA erlaubt			    (ATAPI: ja)
     /PF:xxxx						    (0)
	Register Zugriffsoptionen
     /IT:x						    (BIOS)
	Inactivity timer (DECIMAL)
     /APM:x						    (GerÑtezustand)
	Advanced Power Management (DECIMAL)
	1 (max. Einsparung) ... 254 (max. Geschwindigkeit)
     /LPM:x						    (GerÑtezustand)
	SATA Link Power Management (DECIMAL)
	0 (max. Einsparung) ... 3 (abgeschaltet, max. Geschwindigkeit)

     Adapter-Optionen
     ----------------

     /A:nn						    (-/-)
	Adapter Nummer (0, 1, .. 15)
     /LOC:bus:device.function#channel			    (-/-)
	weise PCI-GerÑt und Kanal diesem Adapter zu
     /P:hhh						    (PCI)
	Basisport Adresse (HEX)
     /PORT:hhh
	wie /P
     /IRQ:n						    (PCI)
	IRQ Nummer (DECIMAL)
     /I 						    (off)
	Ignoriere Adapter
     /!BM						    (ATA  : ja)
	(nicht) BusMaster DMA erlaubt			    (ATAPI: ja)
     /PF:xxxx						    (0)
	Register Zugriffsoptionen
     /80WIRE						    (Automatik)
	80-poliges Kabel vorhanden
     /FORCEGBM						    (aus)
	Force Generic Busmaster mode
     /TO:n (DECIMAL)					    (5s/dynamisch)
	Interrupt/Kommando Wartezeit
     /BAY						    (aus)
	Adapter ist mit einer Device Bay verbunden
     /IT:x						    (BIOS)
	Inactivity timer (DECIMAL)
     /APM:x						    (GerÑtezustand)
	Advanced Power Management (DECIMAL)
	1 (max. Einsparung) ... 254 (max. Geschwindigkeit)
     /LPM:x						    (GerÑtezustand)
	SATA Link Power Management (DECIMAL)
	0 (max. Einsparung) ... 3 (abgeschaltet, max. Geschwindigkeit)

     Unit-Optionen
     -------------

     /U:n						    (-/-)
	Einheit Nummer (0, 1)
     /UNIT:n
	wie /U
     /I 						    (off)
	Ignoriere Einheit
     /T:n						    (5s)
	Fehler-Wiederholintervall in Sekunden (DECIMAL)
     /!SMS						    (Automatik)
	Kein Blockmodus
     /SMS:n						    (Automatik)
	Setze SMS BlocklÑnge auf n
     /!DM						    (aus)
	Verhindert OS2DASD.DMD Zugriff auf das GerÑt
     /IT:x						    (BIOS)
	InaktivitÑtsintervall (DECIMAL)
     /MR:udp						    (Maximum)
	Limitiere Datenrate eines GerÑts
     /PF:xxxx						    (0)
	Register Zuriffsoptionen
     /NL:n						    (aktueller GerÑte-
	GerÑuschpegel, n = 0 (leise) ... 127 (laut)			zustand)
     /!SETMAX						    (volle KapazitÑt)
	volle Platten-KapazitÑt nicht freischalten
     /WP, /WP:0 					    (aus)
	Schreibschutz fÅr die ganze Platte oder nur Track 0
     /!BM						    (ATA  : ja)
	(nicht) BusMaster DMA erlaubt			    (ATAPI: ja)
     /APM:x						    (GerÑtezustand)
	Advanced Power Management (DECIMAL)
	1 (max. Einsparung) ... 254 (max. Geschwindigkeit)
     /LPM:x						    (GerÑtezustand)
	SATA Link Power Management (DECIMAL)
	0 (max. Einsparung) ... 3 (abgeschaltet, max. Geschwindigkeit)


     Veraltete Optionen
     ------------------

***  /!RMV

     Obsolete Optionen
     -----------------

     /GEO
     /LBA
     /!CYLA
     /DC:n
     /!DSG
     /DT:x
     /NEC
     /PCLK:0
     /MGAFIX
     /!R
     /FORCE
     /ATAPI
     /!ATAPI
     /PCMCIA

     Undokumentierte Optionen
     ------------------------

     /LAT
     /FIXES
     /DEBUG



KOMMANDOZEILENPARAMETER DETAILS
     Seit Verison 1.0.8 dieses Treibers wird auch der undokumentierte Schalter
     /!SHUTDOWN wie im letzten IBM1S506.ADD unterstÅtzt. In dieser Version
     sendet der IBM1S506 shutdown Kommandos an alle angeschlossenen GerÑte.
     Dieses Verhalten ist anders, als in den vorhergehenden Versionen.

     Ich habe viele Berichte Åber Probleme gesehen, wenn die Laufwerke runter
     gefahren werden. Deshalb habe ich mich entschieden, an dieser Stelle nicht
     lÑnger die KompatibilitÑt zum IBM-Treiber zu wahren. DANIS506 toleriert die
     Option /!SHUTDOWN auf der Kommandozeile, aber er tut nichts. Wenn Du dieses
     neue Shutdown-Verhalten willst, mu·t Du die Option /SHUTDOWN wÑhlen (*ohne*
     !), was auf Notebooks vielleicht sinn- voll sein mag.

     Als Faustregel gilt: Wenn Dein System nicht unter irgendwelchen,
     mîglicherweise unbekannten Fehlern leidet, ist nicht eine einzige
     Kommandozeilenoption notwendig. Der Treiber bindet sich selbst in die
     Umgebung ein und lÑuft mit maximaler Geschwindigkeit.

     In manchen Situationen kann es jedoch sein, dass Du einige der folgenden
     Optionen brauchst, um die optimale Leistung zu erreichen:

     - ATAPI-GerÑte werden nur im PIO-Modus initialisiert wenn sie nur sehr
       frÅhe Versionen der ATAPI Spezifikation zu unterstÅtzen scheinen;
       dasselbe gilt, wenn der IDE Chip bekannterma·en keinen PCI
       Busmasterbetrieb mit ATAPI-GerÑten unterstÅtzt. Im ersten Fall kannst Du
       trotzdem versuchen, bestimmte GerÑte im Busmaster-DMA Modus laufen zu
       lassen, indem du die entsprechenden /A:x /U:y /BM Optionen anfÅgst.

     - einige ChipsÑtze benîtigen den /80WIRE Schalter, um ATA66-Betrieb zu
       ermîglichen (siehe auch unten)

     - falls das DumpIDE-Hilfsprogramm einen nicht unterstÅtzten, aber
       Busmaster fÑhigen Chip entdeckt und dann den Schalter /GBM verlangt
       (siehe auch unten).

     - falls GerÑte im laufenden Betrieb gewechselt werden sollen oder
       PCCard-GerÑte eingesetzt werden.

     ------------------------------------------------------------------------

     FÅr alle diejenigen unter uns, die der Auffassung sind, da· moderne
     Computer ohnehin vieeel zu schnell sind, um damit klarzukommen, hat IBM uns
     dankenswerterweise den Schalter /W mitgegeben (er ist jetzt seit rund einem
     Jahr dabei). Dieser Schalter ersetzt den Parameter /V und genauso wie /V
     zeigt er einige sehr nÅtzliche Informationen Åber das EIDE-System wÑhrend
     der Computer bootet. Aber anstatt das ganze Zeug auf den Schirm zu bringen
     und weiterzuscrollen, erzeugt /W kleine HÑppchen und *wartet* dann auf den
     User, der sodann eine Taste drÅcken soll, nachdem er alles auswendig
     gelernt hat ;-).

     Damit /W funktioniert mu· das Warten bei Fehlern in CONFIG.SYS
     eingeschaltet sein, entweder mit "PAUSEONERROR=yes" oder durch Åberhaupt
     keinen PAUSEONERROR Eintrag.


     Um den MÅll auf dem Bildschirm zu reduzieren und mîgliche SYS2068-Hinweise
     zu vermeiden, kînnen einige Zeilen der Boot-Meldungen daruch unterdrÅckt
     werden, da· /VL (/WL) anstelle von /V (/W) agegeben wird. Fall noch weniger
     der Boot-Info gewÅnscht ist, dann gibt /VLL (/WLL) nur noch Basis-Meldungen
     aus. Hier ist ein Beispiel:

     Mit /V oder /W sieht das so aus:

		 Daniela's Bus Master IDE Driver for OS/2 Version 1.3.8
     Controller:0  Port:01F0 IRQ:0E  Status:OK Bus Master DMA Scatter/Gather
	PCI Rev: 2.10 VIA 571 PCI to IDE IC Rev:06 VID:1106 DID:0571 @33MHz
      Unit:0 Status:OK ATAPI Device Bus Master DMA DMA1/PIO3
       Model:IOMEGA  ZIP 250	   ATAPI	      51.G
     Controller:1  Port:0170 IRQ:0F  Status:OK Bus Master DMA Scatter/Gather
	PCI Rev: 2.10 VIA 571 PCI to IDE IC Rev:06 VID:1106 DID:0571 @33MHz
      Unit:0 Status:OK ATAPI Device Bus Master DMA Ultra DMA2/PIO4
       Model:Pioneer DVD-ROM ATAPIModel DVD-115  0108 E1.08
      Unit:1 Status:OK SMS:16 LBA Bus Master DMA DMA2/PIO4 Identify
       Model:CASTLEWOOD ORB2-E			      USR-4.08
	OS2:log   phys BIOS:log  BPB:log  IDE:log   phys     Total Sectors
       C    534   4273	      0 	      534   4273   Avail   4307184
       H    128     16	      0        0      128     16   OS2	   4306176
       S     63     63	      0        0       63     63   % Used    99.98
     Controller:2  Port:A000 IRQ:09  Status:OK Bus Master DMA Scatter/Gather
	PCI Rev: 2.10 CMD 649 PCI to IDE IC Rev:02 VID:1095 DID:0649 @33MHz
      Unit:0 Status:OK SMS:16 LBA Bus Master DMA Ultra DMA4/PIO4 BPB
       Model:IBM-DJNA-352030			      J58OA30K
	OS2:log   phys BIOS:log  BPB:log  IDE:log   phys     Total Sectors
       C   2482  39560	   1023 	    39560  16383   Avail  39876480
       H    255     16	    255      255       16     16   OS2	  39873330
       S     63     63	     63       63       63     63   % Used    99.99
     Controller:3  Port:A800 IRQ:09  Status:OK Bus Master DMA Scatter/Gather
	PCI Rev: 2.10 CMD 649 PCI to IDE IC Rev:02 VID:1095 DID:0649 @33MHz
      Unit:0 Status:OK SMS:16 LBA NL:64 Bus Master DMA Ultra DMA5/PIO4 BIOS
       Model:IBM-DTLA-307030			      TX4OA50C
	OS2:log   phys BIOS:log  BPB:log  IDE:log   phys     Total Sectors
       C  14890  59560	    620 	    59560  16383   Avail  60036480
       H     64     16	     64        0       16     16   OS2	  60036480
       S     63     63	     63        0       63     63   % Used   100.00
     Controller:4  Port:B400 IRQ:09  Status:OK Bus Master DMA Scatter/Gather
	PCI Rev: 2.10 HPT 370 PCI to IDE IC Rev:03 VID:1103 DID:0004 @33MHz
      Unit:0 Status:OK SMS:16 LBA Bus Master DMA DMA2/PIO4 BPB
       Model:QUANTUM FIREBALL_TM1280A		      A6B.2400
	OS2:log   phys BIOS:log  BPB:log  IDE:log   phys     Total Sectors
       C    621   2484	    524 	      621   2484   Avail   2503872
       H     64     16	    255       64       64     16   OS2	   2503872
       S     63     63	     63       63       63     63   % Used   100.00
     Controller:5  Port:BC00 IRQ:09  Status:OK Bus Master DMA Scatter/Gather
	PCI Rev: 2.10 HPT 370 PCI to IDE IC Rev:03 VID:1103 DID:0004 @33MHz
      Unit:0 Status:OK SMS:16 LBA Bus Master DMA Ultra DMA2/PIO4 BPB
       Model:ST34310A				      3.07
	OS2:log   phys BIOS:log  BPB:log  IDE:log   phys     Total Sectors
       C    524   8354	    534 	      524   8354   Avail   8420832
       H    255     16	    128      255      255     16   OS2	   8418060
       S     63     63	     63       63       63     63   % Used    99.97

     Mit /VL oder /WL ist das ein wenig eingedampft:

		 Daniela's Bus Master IDE Driver for OS/2 Version 1.3.8
     Controller:0  Port:01F0 IRQ:0E  Status:OK Bus Master DMA Scatter/Gather
      Unit:0 Status:OK ATAPI Device Bus Master DMA DMA1/PIO3
       Model:IOMEGA  ZIP 250	   ATAPI	      51.G
     Controller:1  Port:0170 IRQ:0F  Status:OK Bus Master DMA Scatter/Gather
      Unit:0 Status:OK ATAPI Device Bus Master DMA Ultra DMA2/PIO4
       Model:Pioneer DVD-ROM ATAPIModel DVD-115  0108 E1.08
      Unit:1 Status:OK SMS:16 LBA Bus Master DMA DMA2/PIO4 Identify
       Model:CASTLEWOOD ORB2-E			      USR-4.08
     Controller:2  Port:A000 IRQ:09  Status:OK Bus Master DMA Scatter/Gather
      Unit:0 Status:OK SMS:16 LBA Bus Master DMA Ultra DMA4/PIO4 BPB
       Model:IBM-DJNA-352030			      J58OA30K
     Controller:3  Port:A800 IRQ:09  Status:OK Bus Master DMA Scatter/Gather
      Unit:0 Status:OK SMS:16 LBA NL:64 Bus Master DMA Ultra DMA5/PIO4 BIOS
       Model:IBM-DTLA-307030			      TX4OA50C
     Controller:4  Port:B400 IRQ:09  Status:OK Bus Master DMA Scatter/Gather
      Unit:0 Status:OK SMS:16 LBA Bus Master DMA DMA2/PIO4 BPB
       Model:QUANTUM FIREBALL_TM1280A		      A6B.2400
     Controller:5  Port:BC00 IRQ:09  Status:OK Bus Master DMA Scatter/Gather
      Unit:0 Status:OK SMS:16 LBA Bus Master DMA Ultra DMA2/PIO4 BPB
       Model:ST34310A				      3.07

     Und mit /VLL oder /WLL wird es ganz wortkarg:

		 Daniela's Bus Master IDE Driver for OS/2 Version 1.3.8
       Model:IOMEGA  ZIP 250	   ATAPI	      51.G
       Model:Pioneer DVD-ROM ATAPIModel DVD-115  0108 E1.08
       Model:CASTLEWOOD ORB2-E			      USR-4.08
       Model:IBM-DJNA-352030			      J58OA30K
       Model:IBM-DTLA-307030			      TX4OA50C
       Model:QUANTUM FIREBALL_TM1280A		      A6B.2400
       Model:ST34310A				      3.07

     UnabhÑngig vom gewÑhlten Detailgrad durch den manche Zeilen auf dem Bild-
     Schirm unterdrÅckt werden kînnen, werden jedoch *alle* Zeilen intern
     gespeichert, um sie spÑter zurÅckzuholen.

     Seit Beta 7 speichert der Treiber alle mîglichen Meldungen, die beim Booten
     auftauchen kînnen, intern ab. Diese Meldungen kann man wieder auf dem
     Bildschirm sichtbar machen, indem man:

     COPY IBMS506$ con:

     tippt oder

     COPY IBM506$ anyfile (z.B. BOOTLOG.LOG oder wie auch immer - KK)

     Achte bitte auf die Schreibung der Kommandos!

     Vor einiger Zeit hat IBM sich entschieden, den /SMS Schalter als
     Voreinstellung fÅr die meiste Controller Hardware zu nehmen (Hinweis: mit
     SMS-Modus wird der Modus bezeichnet, der es ermîglicht, mehrere Blîcke in
     *einer* Anforderung von der Platte zu lesen - KK). Der Schalter /!SMS
     schaltet diesen Default-Wert folglich ab. Wenn aber die Festplatte selber
     'meldet', sie sei SMS-fÑhig, dann wird vom Treiber auch SMS eingestellt,
     gleichgÅltig, ob /!SMS gesetzt ist oder nicht. Weil dies hin und wieder zu
     Fehlern auf mancher Hardware fÅhrt, wie einige User berichteten, habe ich
     die Funktion des /!SMS Schalters dahingehend geÑndert, da· er in *jedem*
     Falle beachtet wird, egal was die Hardware meldet.

     Manchmal ist es nicht nîtig, den SMS-Modus komplett abzustellen, sondern
     lediglich die Zahl der Sektoren zu verringern, die mit einer Anforderung
     auf einmal Åbertragen werden. Um dieses Feature zu implementieren, wird die
     /SMS Option in die Form /SMS:n geÑndert, wobei n die Anzahl der auf einmal
     zu Åbertragenden Sektoren angibt. Wenn n auf 0 oder 1 gesetzt wird, verhÑlt
     sich der Treiber genauso, als wÑre /!SMS gesetzt worden. Jede Festplatte
     hat eine maximale Anzahl von Sektoren, die bei einer Anforderung durch den
     Controller gesendet werden kînnen und dies ist abhÑngig vom Hersteller und
     vom Modell. Du kannst keinen Wert hîher als den fÅr das jeweilige Modell
     spezifizierten setzen. Der Treiber setzt den SMS-Wert immer so, da· er dem
     Minimum des durch n gegebenen Wertes entspricht, aber niemals hîher als den
     durch das Laufwerk berichteten Wert.

     -----------------------------------------------------------------------

     Um den Ultra DMA Modus 3 (44MB/sec), den Ultra DMA Modus 4 (66MB/sec),
     den Ultra DMA Modus 5 (100MB/s) oder den Ultra DMA Modus 6 (133MB/s) nutzen
     zu kînnen, mÅssen *ALLE* im folgenden genannten Voraussetzungen erfÅllt
     sein:

     - der EIDE-Controller mu· die ATA-66/100 Erweiterungen unterstÅtzen
     - das GerÑt mu· die ATA-66/100 Erweiterungen unterstÅtzen
     - das Kabel mu· ein 80-Leitungen Kabel sein (auf jeden Fall
       erforderlich)
     - das Motherboard mu· die Erkennung von 80-Leitungen Kabeln
       unterstÅtzen (siehe #)
     - der EIDE-Controller mu· ein 80-Draht Kabel als vorhanden melden
     - das angeschlossene GerÑt mu· das 80er Kabel als vorhanden melden

     # einige Chipsatzhersteller fÅgen nach wie vor keine entsprechenden Pins
       bei, um die Erkennung eines solchen Kabels eindeutig zu ermîglichen und
       haben deswegen auch keine standardisierte Funktion entwickelt, die es
       Treiber-Entwicklern ermîglicht, diese *elementare* Information zu
       bekommen. Jedes Board mit einer VIA596B, VIA686 oder AMD756 south bridge
       ist davon betroffen: die ATA-66 FÑhigkkeiten werden nicht als
       Standardeinstellung vom Treiber gewÑhlt, weil es keine Mîglichkeit gibt,
       das Vorhandensein eines 80er Kabels verlÑ·lich festzustellen. In diesem
       Falle mu· die Option /80WIRE fÅr den *ADAPTER* Treiber dezidiert
       eingestellt werden, wenn wirklich ein solches Kabel an dem entsprechenden
       EIDE-Kanal angeschlossen ist. Die Entscheidung darÅber liegt aber
       vollstÑndig bei *DIR*. Mache bitte nicht mich fÅr verlorene oder
       beschÑdigte Daten verantwortlich, wenn Du das Falsche eingetragen hast.

       Um diese LÑstigkeit mit den genannten Chips zu umgehen, prÅft der Treiber
       ab Version 1.3.0 die vom BIOS eingestellte Konfiguration des Controllers.
       Wenn ein auf ATA-66 initialisierter Kanal gefunden wird, nimmt der
       Treiber an, da· das BIOS ein 80-Draht Kabel entdeckt hat.

     ----------------------------------------------------------------------

     Die folgenden Optionen aktivieren Mîglichkeiten, die ich hinzugefÅgt habe:

     -----------------------------------------------------------------------

     UnterstÅtzung von Drive-Bays und PCCard-Slots

     Viele Notebooks besitzen sogenannte Drive-Bays zum Austausch verschiedener
     GerÑte (Floppy, Disk, CD/DVD, o.Ñ.) wÑhrend des Betriebs. Mit dem Schalter
     /BAY wird der entsprechende IDE-Adapter fÅr den GerÑtetausch prÑpariert.
     Damit das auch unter OS/2 gefahrlos funktioniert, mu· die UnterstÅtzung fÅr
     APM (mittels DEVICE=APM.SYS) installiert sein. WÑhrend eines APM Suspends
     dÅrfen die GerÑte ausgetauscht werden. Der Floppy-Treiber und die
     verschiedenen ATAPI-Filter von IBM prÅfen nach einem APM Resume, ob
     passende GerÑte vorhanden sind und betreiben sie dann.

     Seit Release 1.1.9 verbessert DaniS506.ADD diese "Hot-Swap" UnterstÅtzung.
     Nach einem APM Resume inspiziert der Treiber die an diesen "speziellen"
     Adapter angeschlossenen Units und rekonfiguriert sowohl das GerÑt als auch
     den Kontroller in derselben Weise, wie es auch beim Booten geschieht.
     Danach meldet der Treiber die gefundenen Ergebnisse an daran interessierte
     Filter-Treiber, die diese Units bedienen, soda· auch diese sich anpassen
     kînnen. Momentan unterstÅtzt nur DaniATAPI.FLT dieses erweiterte
     Rekonfigurations-Protokoll.

     Bespiel:

     Ein Notebook hat ein Drive-Bay mit wechselbarer Floppy, Festplatte, ZIP
     und DVD-CDR/W. Mit den folgenden Zeilen in CONFIG.SYS sind alle diese
     GerÑte wÑhrend des Betriebes austauschbar und benutzbar:

     BASEDEV=IBM1FLPY.ADD /A:0 /FORCE:1 /U:0 /F:1.44MB
     BASEDEV=DaniS506.ADD [other options] /A:1 /BAY  (siehe #)
     BASEDEV=DaniATAPI.FLT /A:1 /U:0 /TYPE:ZW

     #: unter der Annahme, da· der sekundÑre Kanal mit dem Drive Bay verbunden
     ist.

     Das ZIP-Drive und die Festplatte erscheinen nach einem "Refresh der
     Wechselmedien" als Wechsellaufwerk im "Laufwerke"-Folder. Wichtig: vor dem
     Entnehmen der GerÑte ist *unbedingt* ein Auswurf des Mediums zu veranlassen
     (entweder Åber "EJECT x:" von der Kommandozeile oder Åber das KontextmenÅ
     des Laufwerks-Icons)! Wird das vergessen kînnen alle Daten verlorengehen,
     da die Filesystem-Caches noch nicht auf die Medien zurÅckgeschrieben sind.
     Mit ein wenig GlÅck repariert in solch einem Fall das Kommando "ChkDsk x:
     /F" das defekte Medium wieder ohne Datenverlust.

     Ab Release 1.3.0 unterstÅtzt der Treiber auch PCCard-Slots. Dies wird mit
     Hilfe der Option /PCS oder /PCS:n freigeschaltet. /PCS untersucht, wieviele
     PCCard Slots vom Socket Services Treiber zu VerfÅgung gestellt sind und
     erzeugt dafÅr genau so viele "virtuelle" IDE-Adapter. Wenn weniger Adapter
     fÅr PCCards eingerichtet werden sollen als vorhanden, dann kann diese
     Anzahl n Åber die Option /PCS:n festgelegt werden. Entsprechend weniger
     PCCards mit IDE-GerÑten dÅrfen dann gleichzeitig in den PCCard-Slots
     eingesteckt sein.

     Ein "virtueller" PCCard IDE-Adapter wird durch eine PCCard (der eigentliche
     IDE Controller) implementiert, die in irgendeinen der PCCard EinschÅbe
     eingesteckt ist. Jede unterstÅtzte PCCard, die *gleichzeitig* mit anderen
     eingesteckt ist, zÑhlt als ein IDE-Adapter. Der Treiber hÑngt sich an das
     OS/2 PCMCIA-Subsystem, und nimmt jede PCCard unter seine Kontrolle, die
     Function ID 4 (Disk) und Function Extension 1 (ATA-Interface) aufweist;
     dies beinhaltet auch PCCard ATAPI-GerÑte (wie z.B. das PCMCIA ZIP-250 oder
     das Click!40). Ab Release 1.3.10 sind sowohl ATA als auch ATAPI-GerÑte
     unterstÅtzt (sofern DaniATAPI.FLT Release 0.3.0 oder neuer installiert
     ist). PCCards dÅrfen beliebig ein- und ausgesteckt werden. Die einzige
     Voraussetzung sind ein funktionierender Socket Services Treiber und
     PCMCIA.SYS. Vorsicht: Ñltere Versionen von IBMs PCMCIA-Subsystem haben
     Fehler, die zu Fehlfunktionen fÅhren kînnen beim Konfigurieren von PCCards
     in anderen EinschÅben als dem ersten.

     Nach dem Einstecken einer PCCard in einen Slot hîren Sie wahrscheinlich ein
     paar GerÑusche von der PCCard oder der daran angeschlossenen Einheit. Kurz
     danach sollte ein hoher Piepston zu hîren sein. Dieser Piepser zeigt an,
     da· der Treiber die PCCard akzeptiert hat, ihr erfolgreich Resourcen
     zuweisen und sie initialisieren konnte, und erfolgreich mit der ange-
     schlossenen Einheit kommunizieren konnte. Falls der Piepser nicht zu hîren
     sein sollte, versuchen Sie die PCCard nochmals einzustecken. Eine
     fehlgeschlagene Initialisierung wird druch durch zwei tiefe Piepser
     angezeigt.

     Wenn Sie eine PCCard entfernen mîchten, vergessen Sie nicht, das Filesystem
     des angeschlossenen GerÑtes zu schlie·en, entweder mittels "EJECT x:" von
     der Kommandozeile aus, oder Åber das KontextmenÅ des Laufwerks.
     Anderenfalls bleibt das Filesystem in einem inkonsistenten "dirty" Zustand,
     der hîchstwahrscheinlich erst durch CHKDSK korrigiert werden mu· bevor das
     Medium wieder zugreifbar wird. Ein "Eject" fÅhrt nicht unbedingt zu einem
     Auswurf des Mediums aus dem Laufwerk (beispielsweise beim Click!40 ist das
     so); seinen Sie also nicht erstaunt darÅber. Ein wenig AktivitÑt auf dem
     GerÑt zeigt an, da· die bisher noch nicht auf das Medium geschriebenen
     Inhalte des Filesystem-Caches nun auf das Medium gesichert werden. Das
     Ende dieser Operation zeigt ein mittelhoher Piepston an. Danach ist es
     sicher, die PCCard aus dem Schacht oder das Medium aus dem Laufwerk zu
     entnehmen.

     Ab Version 1.6.0 kann der Treiber auch mit PCCards umgehen, von denen
     gebootet wird und die daher schon vom BIOS initialisiert sind (Beispiel
     Sony Vaio Crusoe Subnotebook mit bootfÑhigem externem CD-ROM). Dazu sind
     gewisse technische Voraussetzungen zu erfÅllen (der PCCard Slot mu·
     ExCA-Registerkompatibel sein) und au·erdem darf kein Socket Services
     Treiber geladen sein; letzteres liegt allerdings an Fehlern in den Socket
     Services Treibern, die einen Bootvorgang von durch das BIOS initialisierten
     PCCards unmîglich macht.

     /BAY an SATA-KanÑlen ermîglicht das Hotplugging von SATA und SATAPI GerÑten.
     Dies ist besonders nÅtzlich im Zusammenhang mit Hot-Swap-EinschÅben.

     ----------------------------------------------------------------------

     Moderne Festplatten besitzen verschiedene Mîglichkeiten, Strom zu sparen.
     Bei geringer AktivitÑt werden vorÅbergehend interne Schaltkreise
     deaktiviert oder gegebenenfalls auch die Motoren abgeschaltet. Diese
     Funktionen werden unter dem Begriff "Advanced Power Management" (APM)
     zusammengefa·t. Die Balance zwischen Zugriffsgeschwindigkeit und Ersparnis
     beim Stromverbrauch ist einstellbar.

     Zu diesem Zweck ist die Option /APM:n implementiert, die fÅr einzelne,
     mehrere oder alle Platten wirksam ist, die diese Funktion unterstÅtzen. Der
     Wert 'n' reicht von 1 bis 255; aufsteigende Werte bedeuten bessere
     Zugriffsgeschwindigkeit, der Wert 255 schaltet alle Stromsparfunktionen ab.
     Welcher Wert welche Bedeutung hat liegt ganz im Ermessen des Herstellers.
     Interessierte Anwender sind gehalten, diese Informationen *selbst* aus den
     DatenblÑttern der Hersteller zu entnehmen, ich werde auf diesbezÅgliche
     Anfragen nicht reagieren!

     Mein Tip ist, es einfach mal mit dem Wert 128 zu versuchen, denn der
     erlaubt es alle Stromsparmîglichkeiten zu nutzen, ohne da· der Spindelmotor
     der Platte abgeschaltet wird. Aus diesem Grund ist der zu erwartende
     Geschwindigkeitverlust beim ersten Zugriff auf die Platte nach lÑngerer
     InaktivitÑt minimal.

     Fall eine Platte die APM-Funktion implementiert hat, ist diese dem weiter
     unten beschriebenem InaktivitÑts-Timer vorzuziehen! Ein Aufruf von
     "DiskInfo I" zeigt, ob eine Platte die APM-Funktion eingebaut hat:

     abgeschaltetes, aber implementiertes APM:
	     Advanced power management level: disabled
	     Commands/features:
		Enabled Supported
			Advanced Power Management feature set

     aktiviertes APM auf Level 128:
	     Advanced power management level: 128
	     Commands/features:
		Enabled Supported
		   *	Advanced Power Management feature set

     ----------------------------------------------------------------------

     Die SATA-Spezifikation enthÑlt eine optionale Funktion, den Stromverbrauch
     einer SATA-Verbindung zu steuern. Je mehr Funktionseinheiten einer
     SATA-Verbindung abgeschaltet sind, desto lÑnger braucht es, diese wieder in
     Betrieb zu nehmen. Es existiert keine allgemein verbreitete
     Standardmîglichkeit, den Stromsparzustand einer SATA-Verbindung von der
     Kontroller-Seite aus zu steuern, aber moderne SATA-Festplatten sind oft in
     der Lage, bei InaktivitÑt die Stromspar-Modi zu aktivieren. Mittels der
     Option /LPM:n (Link power Management) kann diese Funktion fÅr einzelne,
     mehrere oder alle Festplatten erlaubt werden, die dies implementiert haben,
     und fÅr die auch auf der Kontrollerseite dies eingebaut und freigeschaltet
     ist.

     Der Parameter 'n' kann die folgenden Werte annehmen:

       0: Stromersparnis soweit es der Kontroller gemÑ· BIOS-Einstellung erlaubt
       1: alle Stromsparmodi werden bedingungslos freigeschaltet
       2: alle Stromsparmodi au·er Tiefschlaf werden bedingungslos
	  freigeschaltet
       3: alle Stromparmodi sind bedingungslos abgeschaltet, maximale
	  Geschwindigkeit

     AbhÑngig von der Hardware-Kombination kînnen einzelne Werte zu
     Fehlfunktionen fÅhren oder keine Wirkung zeigen. Im Allgemeinen ist die
     Option /LPM:0 die Einstellung der Wahl. Jeder Anwender ist gehalten, hier
     bei Problemen die Funktion abzuschalten, da der Treiber keinen Einflu· auf
     die korrekte Implementierung dieser Funktion in der vorliegenden Hardware
     hat.

     Ein Aufruf von "DiskInfo I" beantwortet die Frage, ob eine Festplatte die
     notwendigen Voraussetzungen mitbringt:

     Voraussetzung erfÅllt, aber Funktion abgeschaltet:
	     Commands/features:
		Enabled Supported
			Device-initiated interface power management

     Voraussetzung erfÅllt, Stromspar-Funktion aktiv:
	     Commands/features:
		Enabled Supported
		   *	Device-initiated interface power management

     Ein Aufruf von "DumpIDE" zeigt den momentanen Stromspar-Zustand einer
     SATA-Verbindung:

     SATA link 0:
     Status : 00000123 - device pres., PHY comm; 3.0Gb/s; interface active
     bzw.
     Status : 00000123 - device pres., PHY comm; 3.0Gb/s; i/f power PARTIAL
     bzw.
     Status : 00000123 - device pres., no PHY comm; 3.0Gb/s; i/f power SLUMBER

    ----------------------------------------------------------------------

    Inaktive SATA-Ports werden bedingungslos abgeschaltet, um Strom zu sparen.

    ----------------------------------------------------------------------

     Um den InaktivitÑts-Timer zu nutzen fÅge /IT:x den Parametern fÅr die
     jeweilige Einheit hinzu. x enthÑlt die Timout-Zeit in Minuten. Eine 0
     schaltet die Spindown-Funktion vîllig ab. Wenn Du diese Option nicht
     verwendest, werden einige GerÑte trotzdem nach einiger Zeit der InaktivitÑt
     abschalten.

     Damit diese Funktion korrekt arbeitet, mÅssen *alle* folgenden
     Bedingungen erfÅllt sein:

     - im BIOS muss APM eingeschaltet sein
     - die Festplatten Power-down-Timer des BIOS mÅssen abgeschaltet
       sein
     - in der CONFIG.SYS mu· zumindest das Statement DEVICE=APM.SYS
       enthalten sein (in anderen Worten: der OS/2 APM Support mu·
       installiert sein).

     Wenn diese Vorbereitungen getroffen sind, kann der Treiber den Festplatten
     Power-Down Åberwachen und zwar auch dann, wenn das System zwischenzeitlich
     das APM aussetzt. Dies sichert eine schnelle Fehlererkennung bei kurzen
     Kommando-Timeouts, aber genÅgend lange Timeouts fÅr das Hochfahren der
     Platten.

     Wenn APM unter OS/2 nicht vorhanden ist, wird der Treiber Kommando Timeouts
     bis zu 20 sec verlÑngern (fÅr jedes Kommando), wenn das Laufwerk einen
     vorhandenen Power-Down-Status meldet oder der Benutzer die /IT Option
     eingeschaltet hat; allen anderen Laufwerken wird ein Kommando zum
     Abschalten des automatischen Spin-down gesandt.

     -------------------------------------------------------------

     Um die Åbertragungsgeschwindigkeit, mit der ein Laufwerk kommuniziert, zu
     begrenzen, fÅge den /MR:udp Schalter hinzu. Dabei setze die Werte fÅr u, p
     und d aus den folgenden Tabellen ein ('disable' hei·t: schaltet ab, 'limit
     to' hei·t: begrenzt bis):

	  u: Ultra DMA
	     0	-  disable  Ultra DMA
	     1	-  limit to Ultra DMA mode 0
	     2	-  limit to Ultra DMA mode 1
	     3	-  limit to Ultra DMA mode 2
	     4	-  limit to Ultra DMA mode 3
	     5	-  limit to Ultra DMA mode 4
	     6	-  limit to Ultra DMA mode 5

	  d: Multi Word DMA
	     0	-  disable  MW DMA
	     1	-  limit to MW DMA mode 0 (entspicht beim S506.ADD Modus 0)
	     2	-  limit to MW DMA mode 1
	     3	-  limit to MW DMA mode 2

	  p: PIO
	     0	-  limit to PIO mode 0
	     1	-  limit to PIO mode 1 (beim S506.ADD effektiv PIO 0)
	     2	-  limit to PIO mode 2 (beim S506.ADD effektiv PIO 0)
	     3	-  limit to PIO mode 3 (mit flow control)
	     4	-  limit to PIO mode 4 (mit flow control)

     Wenn Du u und d zugleich auf 0 setzt, entspricht das effektiv einem
     Abschalten des Busmastering auf diesem GerÑt, da kein DMA Modus Åbrig
     bleibt, der verwendet werden kînnte. FÅhrende Nullen kînnen weggelassen
     werden.

     Viele EIDE Controller haben keine Mîglichkeit, PIO-Modi und Multiword
     DMA-Modi unabhÑngig voneinander zu schalten, weil diese Modi die selben
     Timingregister verwenden. Das hat historische GrÅnde und liegt auch an der
     éhnlichkeit der Zeitzyklen. Dies gilt fÅr alle oben genannten ChipsÑtze mit
     Ausnahme des Promise Ultra und des Cyrix MediaGX.

     Hinweis: dies gilt fÅr gemischte Transfermodi an ein und *demselben* GerÑt!
     Die verschiedenen GerÑte am EIDE-Bus sind unabhÑngig voneinander in
     Hinsicht auf die Transfermodi (mit Ausnahme allerdings des Intel 82371FB).

     Um mit dieser Situation klarzukommen, sucht sich der Treiber immer die
     langsamere Zykluszeit unter den jeweils vorgeschlagenen aus. Das
     Endergebnis kann man an untenstehender Tabelle ablesen.

	   | no DMA    MW-DMA 1       MW-DMA 2	    Ultra-DMA x
     ------+----------------------------------------------------------------
     PIO 0 |  PIO0    PIO0/DMA1      PIO0/DMA2	    PIO0/UDMAx	 (Intel,Promise,
	   |							  Cyrix)
     PIO 0 |  PIO0    PIO0/no DMA    PIO0/no DMA    PIO0/UDMAx	 (others)
     ------+----------------------------------------------------------------
     PIO 3 |  PIO3    PIO3/DMA1      PIO3/DMA2	    PIO3/UDMAx	 (Promise,Cyrix)
     PIO 3 |  PIO3    PIO3/DMA1      PIO3/DMA1	    PIO3/UDMAx	 (others)
     ------+----------------------------------------------------------------
     PIO 4 |  PIO4    PIO4/DMA1      PIO4/DMA2	    PIO4/UDMAx	 (Promise,Cyrix)
     PIO 4 |  PIO4    PIO3/DMA1      PIO4/DMA2	    PIO4/UDMAx	 (others)
     -------------------------------------------------------------------------

     Einige Benutzer sind gezwungen (oder fÅhlen sich gezwungen ;-), den PCI-Bus
     auf ihren Motherboard mit anderen Geschwindigkeiten als den optimalen 33
     MHz laufen zu lassen. Etliche Cyrix-Prozessoren brauchen zum Beispiel sehr
     ungewîhnliche Taktfrequenzen, die nicht so leicht durch Teilung auf 33 MHz
     gebracht werden kînnen. Das fÅhrt entweder zu zu niedrigem EIDE Timing oder
     zu zu Schnellem. Der erste Fall mag enttÑuschend sein, aber der zweite
     Åbertaktet das EIDE Interface und kann zerstîrte Daten verursachen. Wenn Du
     die aktuelle PCI-Taktrate Deines Boards kennst, kannst Du eine zusÑtzliche
     Treiberoption verwenden: /PCLK:x (wobei x der Wert des PCI-Taktes in MHz
     ist). Dann wird der PCI Takt (vom User eingestellt) nach 4 Geschwindig-
     keitsklassen sortiert (25, 33, 37 und 41 Mhz), die zur Bootzeit gemeldet
     werden. FÅr jeden dieser Werte *versucht* der Treiber das optimale Timing
     einzustellen, aber wegen einiger UnzulÑnglichkeiten im Chipsatz ist das
     nicht in allen FÑllen mîglich.

     Da heute die meisten Boards den optimalen PCI-Takt von 33 MHz einhalten,
     sollte man diesen Schalter wirklich nur dann einsetzen, wenn es absolut
     notwendig ist.

     Zum technischen Hintergrund dieser Option:

     Der sogenannte "Front Side Bus" ist der Bus, Åber den die CPU mit der
     "north bridge" kommuniziert (diese enthÑlt den Memory-Controller, den
     Cache-Controller, die AGP Bridge, den PCI Arbiter [mein Wîrterbuch sagt
     "Schiedsrichter"?] und optional noch einige andere Bausteine). In
     AbhÑngigkeit vom konkreten Design der North Bridge, wird der PCI-Takt aus
     dem Takt des Front Side Busses abgeleitet und zwar durch Teilen dieses
     Taktes mit einem ganzzahligen Wert (2, 3) oder durch einen gebrochenen Wert
     (2, 2,5, 3), was als synchrones Design bezeichnet wird. Der Takt des
     PCI-Bus kann aber auch durch einen unabhÑngigen Taktgeber erzeugt werden
     (asynchones Design, sehr selten). Auf jeden Fall erlaubt die
     PCI-Spezifikation 2.1 (ohne ihre Erweiterungen) einen maximalen Takt von 33
     MHz fÅr den PCI-Bus.

     VIA, ALi und meistens auch die SiS ChipsÑtze kînnen mit gebrochenen Teilern
     umgehen, die Intel ChipsÑtze nicht.

     Wenn Du genau wei·t, da· Dein PCI-Bus mit 33 Mhz lÑuft (was fÅr die meisten
     heute verkauften Motherboard/CPU-Kombinationen gilt), dann verwende diesen
     Parameter nicht.

     Wenn Du den Takt vorher wei·t (oder aus bestimmten GrÅnden am EIDE-Timing
     drehen willst), fÅge den /PCLK:n Schalter hinzu wobei n der bekannte
     PCI-Takt ist. Der Treiber wird dann die entsprechende
     Geschwindigkeitsklasse von diesem Wert herleiten.

     Diese Geschwindigkeitsklassen sind das Ergebnis typischer FSB-Takte und
     ihrer Teiler:

	  FSB clock / divider -> PCI clock -> class
	   50MHz    /	2     ->  25MHz    -> 25MHz
	   60MHz    /	2     ->  30MHz    -> 33MHz
	   66MHz    /	2     ->  33MHz    -> 33MHz
	   75MHz    /	2     ->  37.5MHz  -> 37MHz
	   75MHz    /	2.5   ->  30MHz    -> 33MHz
	   75MHz    /	3     ->  25MHz    -> 25MHz
	   83MHz    /	2     ->  41.5MHz  -> 41MHz
	   83MHz    /	2.5   ->  33MHz    -> 33MHz
	   95MHz    /	3     ->  31.7MHz  -> 33MHz
	  100MHz    /	3     ->  33MHz    -> 33MHz
	  112MHz    /	3     ->  37.3MHz  -> 37MHz
	  124MHz    /	3     ->  41.3MHz  -> 41MHz


     Entsprechend der gewÑhlten Geschwindigkeitsklasse versucht der Treiber, die
     EIDE Registerwerte zu ermitteln, die die PIO/DMA/ULTRA öbertragungsraten
     nicht Åberschreiten. Meine frÅhreren Treiberversionen und der IBM1S506
     kennen nur die korrekten Werte fÅr die 33 MHZ Klasse. Diese betreiben aber
     den EIDE Bus langsamer als mîglich, wenn z.B. ein 25 MHz PCI-Takt ermittelt
     wurde, Åberschreiten aber die erlaubten Grenzen bei Taktraten von 37 MHz/41
     MHz. Der erste Fall ist unkritisch, aber im zweiten FAll gibt es entweder
     Probleme beim Betrieb (das ist noch  weniger schlimm) oder zerstîrte Daten
     (das ist der richtig schlimme Fall).

     Als Beispiel fÅr mîgliche Kommandozeilenparameter gebe ich hier mal meine
     an:

     BASEDEV=DaniS506.ADD /V /A:0 /U:1 /MR:223 /IT:5 /A:1 /I

     Dieser Aufruf fÅhrt zu folgenden Aktionen: Beim Booten werden einige
     Informationen gezeigt, die Datenrate zur Kommunikation mit dem Primary
     Slave Laufwerk wird auf UDMA1/MWDMA1/PIO3 begrenzt und der Laufwerksmotor
     wird nach 5 Minuten der InaktivitÑt auf diesem Laufwerk abgeschaltet (es
     handelt sich dabei um eine IBM-DTTA351010 Platte). Ebenso wird dem Treiber
     mitgeteilt, sich nicht um den zweiten Kanal zu kÅmmern (am ersten Adapter).

     ---------------------------------------------------------------------

     Die /GBM Option ermîglicht einen Scanlauf auf busmasterfÑhige PCI EIDE
     Controller, wenn keiner der bekannten gefunden wird (das sind momentan die
     Intel, VIA,  ALi, SiS, CMD, Promise, HighPoint, SMSC, AMD, ServerWorks,
     Artop, CMD640 und RZ1000 Chips, von denen die letzten beiden *nicht*
     busmasterfÑhig sind!). Bevor ein Chipsatz vom Treiber als busmasterfÑhig
     akzeptiert wird, mu· er einige 'Gesundheits-Checks' Åber sich ergehen
     lassen. So schaffen es manche BIOSse nicht, die Chips korrekt zu
     initialisieren (so gesehen auf einem Board mit einem UMC8886BF). Als
     Faustregel gilt: wenn Linux einen Chip nicht im DMA-Modus betreibt, dann
     ist er auch nicht standard-busmasterfÑhig.

     Momentan sprechen alle EIDE-Controller, die von den gÑngigen S506 Treibern
     nicht unterstÅtzt werden, jedes angeschlossene GerÑt nur im PIO Modus 0 an
     und dies mit Timing-Werten aus dem BIOS (auch hier fast immer PIO 0, wenn
     das GerÑt dem BIOS nicht bekannt ist). Die Standard-Busmaster-Option
     ermîglicht Åberhaupt erst mal Busmaster-Betrieb und DMA-Modi der
     angeschlossenen GerÑte, wodurch die CPU-Last erheblich reduziert werden
     kann. In diesem Modus spricht der .ADD-Treiber keinerlei CHIP-register an,
     au·er dem Standard PCI Kommandoregister (um Åberhauot PCI-Busmasterbetrieb
     zu ermîglichen) sowie die Register, die im Zusammenhang mit dem
     prinzipiellen Busmasterbetrieb stehen. Er hat aber *keinerlei* Mîglichkeit,
     irgendwelche ULTRA-DMA Modi anzuprechen, wenn dies nicht bereits durch das
     BIOS passiert.

     Wenn Du meinst, dass dieses Verhalten das Standardvorgehen meines Treibers
     sein sollte, dann Ñndere das /GBM Statement in /FORCEGBM um. Dann wird
     *jeder* Chip so behandelt, als sei er ein unkannter Chip. Jedwede
     Programmierung der Timing-Werte fÅr ein angeschlossenes GerÑt mu· dann vom
     BIOS Åbernommen werden. /FORCEGBM gibt es in zwei Varianten: eine globale,
     und eine, die nur einen Kanal betrifft. Falls /FORCEGBM vor allen /A:x
     Optionen steht, dann wirkt es auf alle Adapter-KanÑle; Falls es nach einer
     /A:x Option kommt, dann wirkt es nur auf den gerade angewÑhlten Kanal x.

     In einigen FÑllen kann /FORCEGBM helfen, StabilitÑtsprobleme zu vermeiden,
     die durch vom Treiber eingestellte, ATA-Spec konforme Timingparameter
     entstehen. In der jÅngsten Vergangenheit sind einige Motherboardmodelle
     aufgetaucht, die mit Hilfe ihres BIOS etwas "langsamer getuned" wurden, um
     stabil zu laufen. In diesen FÑllen sind die "korrekten" Timings einfach zu
     schnell und der Boot-Proze· schlÑgt fehl, wenn diese Timings von
     DaniS506.ADD eingestellt werden. Das HinzufÅgen von /FORCEGBM verhindert,
     da· der Treiber die Timingeinstellungen anpa·t, und stattdessen die
     Einstellungen des BIOS weiter verwendet werden.

     Beispiele:

     BASEDEV=DaniS506.ADD /W /GBM /A:0 /U:0 /MR:023
     BASEDEV=DaniS506.ADD /W /FORCEGBM /A:0 /U:0 /MR:023 /A:0 /U:1 /MR:034 /IT:5

     ----------------------------------------------------------------------------

     Es gibt eine neue Option /PF:xxxx, die entweder einem Adapter oder
     einzelnen Units zugeordnet werden kann. Diese Option ist dazu gedacht, das
     Timing der Zugriffe auf Kontroller-Register feiner einzustellen, und
     Kontroller- spezifische Leistungsoptionen freizuschalten. Der Wert 'xxxx'
     ist ein Bitfeld, dessen einzelnen Bits zum endgÅltigen Wert zusammengesetzt
     werden mÅssen. Die Bits 0-7 sind fÅr alle PCI-ChipsÑtze vorgesehen, die
     Bits 8-15 sind Chipset-spezifisch.

     In dieser Treiberversion sind die folgenden Einstellungen mîglich:

      +---+---+---+---+---+---+---+---+---+---+---+---+---+---+-------+
      |15  14  13  12  11  10	9   8 | 7   6	5   4	3   2	1   0 |
      +---+---+---+---+---+---+---+---+---+---+---+---+---+---+-------+
      | 	unbenutzt	      |       unbenutzt       |  (1)  |
      +---+---+---+---+---+---+---+---+---+---+---+---+---+---+-------+


      1) Verzîgerung bei Registerzugriffen
	 0 : 1000 ns  (Standardwert, immer benutzt bei allen nicht-PCI Systemen)
	 1 :  500 ns
	 2 :  250 ns
	 3 : keine Verzîgerung (funktioniert auf den meisten Systemen,
	     prÅfe selbst)

	Der tatsÑchlich fÅr einen EIDE-Kanal benutzte Verzîgerungswert ist der
	grî·te von allen angeschlossenen GerÑten!

     BASEDEV=DaniS506.ADD /A:2 /PF:2 /U:0 /PF:3

     Falls kein Slave-GerÑt vorhanden ist, werden Registerzugriffe nicht
     verzîgert weil die individuelle Einstellung /PF:3 fÅr das GerÑt die
     allgemeine Einstellung /PF:2 fÅr den Adapter Åberstimmt. Falls jedoch
     zusÑtzlich ein Slave-GerÑt vorhanden ist, dann erbt dieses die
     Adapter-Einstellung /PF:2. Der grî·te Verzîgerungswert von beiden GerÑten
     ist dann der tatsÑchlich gÅltige und im Endergebnis ist folglich jeder
     Registerzugriff um 250ns verzîgert.

     ----------------------------------------------------------------------------

     Moderne zur ATA Spec 6 kompatible Laufwerke unterstÅtzen mîglicherweise das
     GerÑusch-Management Feature Set. Damit kannst Du Performance gegen LÑrm
     tauschen (am meisten hîrbar bei schnellen zufÑlligen Zugriffen). Die neue
     Unit-Option /NL:n ermîglicht es, dieses Feature einzustellen: der Wert von
     n darf 0 ... 126 sein ; '0' selektiert leiseste GerÑusche bei hîchstem
     Abfall der Maximalgeschwindigkeit, wÑhrend '126' maximale Leistung bei
     grî·tem LÑrm wÑhlt. Laufwerke mÅssen nicht alle Zwischenwerte unterstÅtzen,
     sie dÅrfen auch den nÑchstgelegenen mîglichen Wert wÑhlen. Au·erdem merken
     sich die Laufwerken den letzten eingestellten Wert intern und halten ihn
     auch Åber Resets oder Ausschaltzeiten hinweg.

     Der Treiber gibt den aktuellen, aus dem Laufwerk ausgelesenen Wert an,
     falls die Option /NL nicht genutzt ist, oder den gewÅnschten Wert n, falls
     /NL:n angegeben ist.

     ----------------------------------------------------------------------------

     Ein Anwender berichtete von Boot-Problemen in einer besonderen Situation,
     in der SCSI und ATA/ATAPI-GerÑte beteiligt waren. Die Lîsung war, BIOS
     INT13 Aufrufe zu vermeiden. Der Treiber fragt das BIOS nach den Geometrien
     der ATA-Laufwerke. Im Allgemeinen ist die Information gar nicht nîtig, da
     die ebtscheidende Quelle fÅr die verwendete Laufwerksgeometrie das Laufwerk
     selbst ist (durch Inspizieren des MBR und der BPBs). Die bedeutet, da· in
     nahezu allen FÑllen keine BIOS INT13 Aufrufe notwendig sind. Die einzige
     Ausnahme ist, wenn die Platte vollkommen leer ist, und diese leere Platte
     mittels OS/2 FDISK kompatibel zur BIOS-Geometrie partitioniert werden soll.

     Falls Sie es also vorziehen, dem Treiber die Nutzung des BIOS zu verbieten,
     fÅgen Sie einfach die Option /!BIOS hinzu. In diesem Fall verschwindet auch
     die "seltsame" VDM, die in manchen Proze·management-Programmen zu sehen
     ist.

     ----------------------------------------------------------------------------

     Neuere Versionen von FDISK und LVM neigen dazu ;-) andere Bootmanager als
     ihren eigenen bei jeder VerÑnderung der Partitionierung zu Åberschreiben.
     In solchen FÑllen kann es angeraten sein, die erste Spur auf dem Bootlauf-
     werk (mit dem Bootmanager-Code) mit einem Schreibschutz zu versehen. Dies
     ist entweder schon wÑhrend des Bootens mîglich mit der Unit-Option
     /A:x /U:y /PROT0 ("PROT null"), oder erst spÑter mit Hilfe des DiskInfo
     Utilites:

       DiskInfo <unit> p 1	Schreibschutz auf <unit> einschalten
       DiskInfo <unit> p 0	Schreibschutz auf <unit> ausschalten

     "DiskInfo ?" zeigt alle Optionen im Detail.

     ----------------------------------------------------------------------------

     Die heute verfÅgbaren gro·en Platten funktionieren oft nicht richtig mit
     Ñlteren BIOSen. Entweder wird die KapazitÑt falsch erkannt, oder manchmal
     bleibt der PC sogar direkt nach dem Einschalten stehen. In solchen FÑllen
     hilft es, die Platten entweder per Jumper in der gemeldeten KapazitÑt zu
     reduzieren, oder mit geeigneter Software so umzuprogrammieren, da· sie
     dem BIOS eine geringere, unkritische KapazitÑt melden.

     Ab Version 1.3.8 ist der Treiber in der Lage, trotz solch einer Umprogram-
     mierung unter OS/2 die volle PlattenkapazitÑt zu nutzen. Dies passiert ganz
     automatisch; falls das nicht gewÅnscht sein sollte, dann mu· dies mit der
     Unit-Option /A:x /U:y /!SETMAX verhindert werden.

     Um nun eine solch problematische Platte auf eine unkritische KapazitÑt
     zu programmieren, ist folgendes Vorgehen am besten:

     1) Platte aus dem BIOS austragen. Damit bootet ggf. der PC wieder.
     2) von einer OS/2 Bootdiskette booten
     3) mit Hilfe des Utilities DiskInfo eine verringerte KapazitÑt eintragen:

	  DiskInfo <unit> m <neue KapazitÑt>,  z.B.
	  DiskInfo 0m m 32G

	Details siehe mit Hilfe "DiskInfo ?"
     4) Reboot
     5) Platte ggf. wieder im BIOS eintragen.


INSTALLATION

     Im Falle eines Upgrades von einem zuvor schon installierten IDE-Treiber
     (hîchstwahrscheinlich IBM1S506.ADD), kopiere DaniS506.ADD in das
     Verzeichnis Startlaufwerk:\OS2\BOOT und benenne den Aufruf von IBM1S506.ADD
     (oder des zuvor installierten IDE-Treibers) in Deiner CONFIG.SYS nach
     DaniS506.ADD um.

     Falls zuvor noch kein IDE-Treiber installiert war, dann mu·t Du folgende
     Zeile in CONFIG.SYS einfÅgen:

       BASEDEV=DaniS506.ADD

     Wahrscheinlich bootest Du in diesem Fall von einem SCSI-Laufwerk. Um OS/2
     nicht durcheinanderzubringen mu·t Du dafÅr sorgen, da· die oben genannte
     Zeile *nach* der Zeile mit dem SCSI-Treiber steht.

     Falls Du lieber Icons jagst, kannst Du diese Aktion auch mit Hilfe von
     DDINSTAL ("OS/2 System"/"System Setup"/"Install/Remove"/"Device Driver")
     durchfÅhren. Aufgrund von MÑngeln in DDINSTALL mu·t Du dann allerdings
     einen zuvor installierten S506 Base Driver in s CONFIG.SYS selbst
     deinstallieren, indem Du entweder die entsprechende Zeile lîschst, oder ein
     'rem' an den Anfang stellst.

DATEIEN

     DaniS506.ADD  Der Treiber selbst
	  DaniS506.DDP	Das GerÑtetreiberprofil fÅr DDINSTAL
	  DaniS506.DOC	Diese Datei liest Du gerade :-)
	  DumpIDE.EXE	Ein Hilfsprogramm um die aktuellen IDE Register zu
			zeigen

	  DiskInfo.EXE	Ein Hilfsprogramm um einige Informationen Åber die
			vorhandenen GerÑte anzuzeigen

	  \nodebug\DaniS506.ADD
			Einer kleinere Treiberversion ohne DEBUG Befehle

	  \nodebug\cmprssd\DaniS506.ADD
			Dasselbe wie zuvor, aber LXlite komprimiert. Es kann
			nicht garantiert werden, da· dies auf jedem System lÑuft

	  \source\DiskInfo.c
			Na rate mal ;-)


FEHLER

     Hoffentlich keine, aber wer wei· ....

     Fehlerberichte ohne die genaue IDE-Konfiguration und die betreffenden
!!!  Transfermodi sowie ohne einen Auszug des DUMP Hilfprogrammes sind ziemlich
!!!  sinnlos. Du solltest diese AuszÅge in einem laufenden *und* fehlerhaften
!!!  System erzeugen. Der einfachste Weg besteht darin, die Bildschirmausgaben
!!!  des DUMP Programmes in eine Datei umzuleiten und zwar so:

     DumpIDE > Good.dmp   oder	 DumpIDE > Bad.dmp

     Viele Anwender beziehen sich auf Treiberversionen mit Hilfe des Datei-
     Datums. La· das aus den folgenden GrÅnden sein:

     - Ich merke mir keine Datumsangaben von Dateien
     - Ich baue fast jeden Tag mehrere Treiber
     - Das Datei-Datum ist leicht zu Ñndern
     - Es gibt viele verschiedene Kalender in der Welt

     Die einzig gÅltige Referenz ist die Versionsnummer des Treibers. Er wird
     wÑhrend des Bootens angezeigt wenn die Optionen /V oder /W vorhanden sind.
     Falls der Boot wenigstens bis zur Kommandozeile klappt, dann enthÑlt die
!!!  Ausgabe von "COPY IBMS506$ irgendeinedatei" in der ersten Zeile die
     Treiber-Versionsnummer. Falls ein Boot unmîglich ist, dann fÅhre das
!!!  Kommando "BLDLEVEL DaniS506.ADD" aus, das etwas Ñhnliches wie dies hier
     ausgibt:

     Signature:       @#DANI:1.2#@##1## 4.7.2000 10:45:10 ....
     Vendor:	      DANI
     Revision:	      1.02
     Date/Time:       4.7.2000 10:45:10
     Build Machine:   Nachtigall
     File Version:    1.2.5   <------------------------------+
     Description:     Adapter Driver for ST506/IDE DASD      |
							     |
     Das ist die volle Versionsnummer -----------------------+

     Ich habe keine Mîglichkeit, TRAPs zu untersuchen, die au·erhalb dieses
     Treibers auftreten (Modulname 'IBMS506$' oder nicht genannt). Wenn ein Trap
     innerhalb des Treibers auftreten sollte, brauche ich folgende
     Informationen: CS:EIP, EAX-EDI, DS und ES. Meine Testsysteme zu Hause (VIA
     und ALi) sowie einige andere Maschinen auf der Arbeit (verschiedene Intel
     Chips) laufen problemlos mit diesem Treiber, demzufolge habe ich kaum die
     Mîglichkeit, Fehler zu reproduzieren.

     Wenn irgendeines Deiner EIDE-GerÑte beim Booten nicht erkannt wird, nimm
     Kontakt mit mir auf. Der Treiber hat speziellen DEBUG-Code eingebaut; ich
     werde Dir dann sagen, wie Du ihn aktivieren und die Ergebnisse der
     Ablaufverfolgung sichern kannst.

     Wenn Du Probleme mit Deinen Festplatten bemerkst, nachdem OS2DASD.DMD
     geladen wurde (das kann man beobachten, wenn man beim Booten, unmittelbar
     nachdem das kleine wei·e KÑstchen links oben erscheint, Alt+F2 drÅckt), so
     lies Dir den folgenden Abschnitt *sehr sorgfÑltig* durch, denn er betrifft
     genau Dich. Ich kann Deine Hardwareprobleme nicht mit Software kurieren.
     Wenn Du der Auffassung bist, da· Deine Probleme aus Hardwarefehlern im EIDE
     Controller selber resultieren, kannst Du mich kontaktieren, nachdem Du
     detaillierte Informationen Åber diesen Bug und mîgliche Softwarelîsungen
     zusammengetragen hast. Momentan habe ich eine leidlich aktuelle Liste mit
     Bugs von Ali und eine andere, die ich selbst zusammengetragen habe, die den
     VIA 586 Chipsatz betrifft.

EINIGE NACHDENKLICHE [WEISE? ;-) - KK] WORTE

     Viele EIDE Hardware, die derzeit kÑuflich zu erwerben ist (oder bereits
     gekauft wurde) hat *sehr* knappe Designgrenzen und ist Ñu·erst empfindlich
     gegenÅber den kleinsten Stîrungen des Signals in den Verbindungskabeln.
     Anders als bei SCSI hat der EIDE-Bus keinerlei Terminatoren an beiden Enden
     der Leitung, um 'Klingeln' oder andere Signalreflektionen zu vermindern.
     Rauschen und öbersprechen sind andere Quellen mîglicher Bitfehler wÑhrend
     der öbertragung; sorgfÑltiges Erden (und zwar sowohl der Daten- wie der
     Stromverbindungen) sind unerlÑ·lich, wenn Ihr vorhabt, mehr als simple
     PIO-Geschwindigkeit zu fahren. Gerade Netzteile sind nicht selten fÅr die
     Erzeugung von Rauschen bekannt!

     Ein sehr geduldiger Nutzer fand eine weitere Quelle von Datenstîrungen nach
     mÑchtig langen und nervtîtenden ZuverlÑssigkeitstests: das Cache-System
     seines Motherboards. Er bemerkte Bitfehler, die verschwanden, wenn er ein
     wenig mit den BIOS-Einstellungen fÅr das Cache-Timing herumprobiert hatte
     (das Pipelining war in diesem Falle der öbeltÑter). Dieser Fall ist in
     keiner Weise mysteriîs! Bedenkt, das ein Busmaster - besonders wenn er mit
     hohen Transferraten laufen soll - der Cachelogik und den entsprechenden
     RAMS eine ganz beachtliche, zusÑtzliche Last aufbÅrdet. Etliche zufÑllige
     und schwer reproduzierbare Fehler von OS/2-Systemen haben ihre Ursache hier
     - sogar ohne EIDE oder SCSI-Busmaster-Contoller.

     Wenn Du der Auffassung bist, da· Deine Daten wegen Bugs in diesem Treiber
     geschreddert wurden, bedenke bitte folgendes:

     Ich habe eine Menge von VerÑnderungen in IBMs Quellcode reingeschrieben,
     vor allem in den Initialisierungsteil, um ALi, SiS, VIA, CMD und Promise
     ChipsÑtze zu unterstÅtzen, um Abschalt-Timer fÅr die Laufwerke einzubauen
     und um andere als die allerschnellsten Transferraten auswÑhlen zu kînnen.
     Manche dieser énderungen kînnen zu Traps beim Booten fÅhren, je nachdem,
     welche Parameterwerte gerade verwendet werden. Ich hoffe, ich habe sie alle
     beseitigt. Diese Traps (erkennbar am Modulnamen 'IBMS506$') kînnen aber
     keine Daten beschÑdigen, da sie auftreten, bevor irgendeine
     Schreiboperation auf das Laufwerk erfolgt ist. Es tut mir leid, wenn Dir
     solches widerfÑhrt. ABER: der eigentliche Code, der sowohl die PIO- oder
     Busmaster-DMA Lese- und Schreiboperationen anfordert, ist *unverÑndert*
     geblieben. Tatsache ist: sÑmtlicher Datentransfer vom Laufwerk zum Rechner
     und zurÅck wird zu 100% von der Laufwerkselektronik und der Hardware des
     Chipsatzes durchgefÅhrt (okay, es sind 99% plus *eine* Instruktion von der
     CDU im Falle von PIO). Der Treiber tritt erst dann auf den Plan, wenn
     irgend ein Teil dieser Hardware einen Fehler meldet oder nicht in der Lage
     war, die Anforderung auszufÅhren.

     Vergi· nicht: PIO- und MWDMA Transfermodi haben keine Mîglichkeit,
     Bitfehler wÑhrend der öbertragung zu bemerken, ULTRA-DMA macht
     CRC-PrÅfungen um die DatenintegritÑt zu erhalten.

     Anstatt nun den jeweils hîchstmîglichen Transferrraten der einzelnen Modi
     hinterher zu hecheln, solltest Du die geringst mîgliche
     öbertragungsgeschwindigkeit fÅr jeden Modus wÑhlen (/MR:120). PIO4 auf
     anderer als bombenstabiler Hardware zu verwenden, die zahlreiche
     VerlÑ·lichkeitstests erfolgreich bestanden hat, ist *sehr* gefÑhrlich. Da
     gro·e Teile der OS2*.INI Dateien beim Shutdown *nicht* mit dem
     fehlerprÅfenden CRC-Verfahren von Ultra-DMA gesichert werden kînnen, mu·
     der .ADD in den fehlertrÑchtigen PIO Modus zurÅckschalten. Ich betrachte
     dies als einen Design-Fehler von OS/2.

     Wenn Du SYSBench oder DISKIO laufen lÑ·t und dabei instabile oder ziemlich
     geringe Datentransferraten beim Test der hîchstmîglichen Transferraten
     feststellst, siehst Du die Effekte von Mehrfachversuchen und Resets der
     ChipsÑtze. Das ist ein Hinweis auf Bitfehler!

     Als Vergleichswerte solltest Du bei der Verwendung von DISKIO unter 'Drive
     cache/bus transfer rate' etwa folgende Werte erwarten kînnen:

	  Ultra-DMA mode 5 : 66MB/s oder mehr
	  Ultra-DMA mode 4 : 44MB/s oder mehr
	  Ultra-DMA mode 3 : 34MB/s oder mehr
	  Ultra-DMA mode 2 : 24MB/s oder mehr
	  Ultra-DMA mode 1 : 17MB/s oder mehr
	  Ultra-DMA mode 0 : 13MB/s oder mehr
	  MW-DMA mode 2    : 11MB/s oder mehr
	  MW-DMA mode 1    :  9MB/s oder mehr


     SYSBench basiert auf dem DISKIO-Code mit einigen VerÑnderungen. So fÅhrt
     DISKIO den 'worst-case' Test durch, d.h. es arbeitet auf den letzten
     Zylinder (in beiden Programmen fÑlschlicherweise als 'Spur' bezeichnet),
     indem es vorwÑrts liest, SYSBench liest rÅckwÑrts. Denke daran, da·
     verschiedene Laufwerke unterschiedliche Strategien fÅr interne Caches haben
     und rÅckwÑrts lesen eine ziemlich ungewîhnliche Art des Zugriffs auf
     Dateisystem-Caches ist, soda· manche Laufwerke durch diesen Test 'geleimt'
     werden und die Ergebnisse Åberaus schlecht aussehen.

     Wenn Du die Datentransferraten in den Kabeln zu Deinen Laufwerken
     beschleunigen willst, dann lasse DISKIO oder Sysbench ohne DMA
     Ratenbegrenzung laufen und beachte die angezeigten Raten fÅr den Zylinder
     (Tack) 0. Von diesen ist die maximale Datentransferrate erreichbar, die
     Åberhaupt physikalisch von der Platte zu holen ist. Dann wÑhle einen
     Transfermocdus, der zu dieser Rate pa·t. Ich bevorzuge ULTRA-DMA Modi vor
     den MW-DMA Modi. Wenn das Laufwerk DMA-fÑhig ist, wÑhle PIO Modus 0 als
     nicht-DMA-Modus (in den wenigen FÑllen, in denen Busmaster-DMA nicht
     mîglich ist).

     Wenn Du fehlerhafte Laufwerkserkennungen oder sogar HÑnger wÑhrend des
     Bootens bemerkst, kannst Du keine verlÑ·lichen Datentransfers danach
     erwarten.

     In allen FÑllen, in denen Du meinst, Du hast zerstîrte Daten entdeckt,
     beachte die Ausgaben, die mit dem /W oder /V Schalter erzeugt werden und
     betrachte dann die Datentransfermodi, die mit Deinem Laufwerk benutzt
     werden. Die erste Ma·nahme sollte sein, alle schnellen Transfermodi
     abzuschalten (durch /!BM und/oder /MR:).

     Wenn Du kurze Pieptîne hîrst, dann hat die Statuseinheit fÅr den
     Datentransfer eine Ausnahmebedingung festgestellt: ein hoher Piepton zeigt
     einen UDMA CRC-Fehler an, ein tiefer Piepton einen Fehler, der von der
     Hardware berichtet wurde, der mîglicherweise zu einem Controller-Reset
     fÅhren kann und ein mittlerer Piepton zeigt einen Kommando-Timeout an (das
     wird Åblicherweise durch ein heruntergefahrenes Laufwerk verursacht).
     Solange Deine Hardware 'fehlerlos' lÑuft, wirst Du *keine* Tîne vom Treiber
     hîren (natÅrlich mit Ausnahme eventuell heruntergefahrener Laufwerke). Mit
     'fehlerlos' meine ich, 'ohne von irgendeiner Instanz erkennbare Fehler'.
     Wenn Du es vorziehst, Harware-Fehler, die durch solcherart Tîne angezeigt
     werden, zu ignorieren, kannst Du mit dem /!AA Schalter (keine hîrbaren
     Warnungen) diese auch abschalten.

     Um den aktuellen Desktop (die ArbeitsoberflÑche) vor SchÑden zu schÅtzen,
     solltest Du Test-Kopien des X:\ArbeitsoberflÑche Verzeichnisbaumes und der
     OS2*.INI-Dateien anlegen und auf diese in einer modifizierten CONFIG.SYS
     verweisen lassen, die in X:\OS2\BOOT liegen sollte. Du kannst diese z.B.
     nach CONFIG.T umbenennen und und sie dann im Wiederherstellungsschirm beim
     erneuten Booten auswÑhlen, indem Du 'T' auswÑhlst. Auf diese Weise hast Du
     immer ein funktionsfÑhiges Arbeitssystem und ein unabhÑngiges Testsystem,
     mit dem Du 'spielen' kannst.


FRAGEN & ANTWORTEN

  1) Sowohl mein EIDE Kontroller als auch meine Harddisk kînnen ATA/66 (oder
     ATA/100), ein 80-poliges Kabel ist installiert. Egal was ich versuche
     (Anleitung lesen, die /80WIRE Option angeben), der Treiber erlaubt nicht
     mehr als UltraDMA Modus 2. Was ist falsch ?

     Hîchstwahrscheinlich versteckt die Harddisk ihre ATA/66- (oder ATA/100)
     FÑhigkeit. Manche Modelle werden vom Hersteller mit dieser Einstellung
     geliefert, um Ñltere BIOSse oder Kontroller nicht zu verwirren. Gib das
     Kommando "DiskInfo i" und sieh nach, was das fraglich Laufwerk in Wort
     88/058 meldet: wenn es etwas ist wie xx07, dann meldet die Harddisk, ATA/33
     zu kînnen; falls es xx1F ist, dann geht auch ATA/66, und im Falle von 0x3F
     ist sogar ATA/100 mîglich. Falls das Laufwerk sich schlechter prÑsentiert
     als es laut Spezifikation eigentlich kînnte, kontaktiere den Hersteller und
     frage nach einem Utility, das die fehlenden Features einschaltet (oft auf
     der Hersteller-Website zu finden).

  2) Manchmal gibt es Fehler nach dem Aufwachen aus dem Suspend-Modus. Was kann
     ich tun ?

     Stelle auf der PCI-Seite des BIOS den Wert bei "Delayed Transactions" um.
     Manche Hardware implementiert dieses Feature nicht ganz korrekt.

  3) Ich habe eine gro·e (> 33GB) PLatte, aber FDISK oderr LVM melden nur einen
     Bruchteil der wahren KapazitÑt. Woher kommt das ?

     Gib das Kommando "COPY IBMS506$ con:" und schau auf die Geometriewerte
     (Beispiel):

       Model:WDC WD400BB-00AUA1 		     18.20D18
	OS2:log   phys BIOS:log  BPB:log  IDE:log   phys     Total Sectors
       C   4865  65535	  16383 	    65535  16383   Avail  78165360
       H    255     16	     16      255       16     16   OS2	  78156225
       S     63     63	     63       63       63     63   % Used    99.98

     Falls die Spalte "OS2:log" einen C Wert von 65535 zeigt, dann war da
     hîchstwahrscheinlich ein 16-Bit öberlauf aufgrund eines schlecht gewÑhlten
     Geometrie "Translation Mode". Vermutlich ist der H Wert 16 anstatt des
     wesentlich passenderen 255 (oder 240).

     Falls Du denselben H-Wert in der "BPB:log" Spalte siehst, dann ist diese
     logische Geometrie auf der Platte selbst gespeichert, entweder in der
     Partitionstabelle und/oder den BPB-Sektoren. In diesem Fall mu· die
     Partitionstabelle mit Nullen Åberschrieben werden, um diesen ungeeigneten
     "Translation Mode" loszuwerden; eine énderung im BIOS alleine reicht nicht
     aus!

     Falls aber nur Nullen in der "BPB:log" Spalte aufgefÅhrt sind, dann gibt
     es auf der Platte noch keine gÅltige Partitionstable und die Åbersetzte
     Geometrie stammt vom BIOS. éndere einfach in den BIOS-Einstellungen den
     öbersetzungsmodus auf "LBA translation".

  4) Ich habe nun Probleme CDs zu lesen, obwohl das mit frÅheren Treiber-
     versionen funktioniert hat. Warum?

     Neuere Treiberversionen schalten den DMA Modus auch fÅr ATAPI-GerÑte ein,
     sofern diese einigerma·en aktuellen ATAPI Implementierungsstands zu folgen
     scheinen. Bei manchen ATAPI-GerÑten funktioniert das trotzdem nicht, und
     deshalb mu· der Busmaster DMA-Modus fÅr diese GerÑte abgeschaltet werden
     (/A:x /U:y /!BM).

DANKESCHôN

     Ich mîchte einigen au·ergewîhnlichen Menschen meinen Dank abstatten, die
     dieses StÅck Programmcode zu einem besseren gemacht haben:

     Helen Terbizan   fÅr ihre unendlichen Anstrengungen, den ALi-Support
		      mîglich zu machen sowie ihre Geduld und Ausdauer wÑhrend
		      der Tests.

     Mark Dodel       fÅr genau die gleiche Geduld und Ausdauer

     Jens Glathe      fÅr seine hilfreichen Tips und den Mut, den SiS-Code zu
		      testen

     Piotr Oniszczuk  fÅr seine durchgehenden VerlÑ·lichkeitsprÅfungen

     Fred Springfield fÅr das Debuggen dieses Wîrterhaufens


NOCH ZU TUN

     Es bleibt noch, IBM davon zu Åberzeugen, diese Features in ihre Version zu
     Åbernehmen.
     geschafft! IBM hat die v1.6.6 Sourcen offiziell Åbernommen.

COPYRIGHT

     DaniS506 - Copyright (c) 1999-2008 Daniela Engert. Alle Rechte vorbehalten.

STATUS DES PROGRAMMES

     DaniS506 ist Freeware.

DISCLAIMER

     DU VERWENDEST DAS PROGRAMM AUF EIGENE GEFAHR! Ich Åbernehme keinerlei
     Verantwortung fÅr SchÑden, Probleme, Haftungen, Ehestreitigkeiten und
     Ñhnliches, die durch den Einsatz, die Unmîglichkeit des Einsatzes,
     Mi·brauch, den Besitz oder Nichtbesitz dieses Programmes direkt oder
     indirekt entstehen kînnten. Ich geben desgleichen keine Garantie fÅr ein
     fehlerfreies Funktionieren oder die Eignung fÅr einen bestimmten Zweck oder
     das angemessene Verhalten des Programmes gegenÅber Tieren, Programmierern
     oder kleinen Kindern ab.

     DIE SOFTWARE WIRD ZUR VERFöGUNG GESTELLT "WIE SIE IST" OHNE AUSDRöCKLICHE
     ODER IMPLIZITE GARANTIEN, WAS EINEN VOLLSTéNDIGEN AUSSCHLUSS JEGLICHER
     GARANTIE BEZöGLICH DER VERKéUFLICHKEIT ODER TAUGLICHKEIT FöR EINEN
     BESTIMMTEN ZWECK MIT EINSCHLIESST. DAS GESAMTE RISIKO BEZöGLICH DER
     LEISTUNGSFéHIGKEIT UND QUALITéT DES PROGRAMMES LIEGT BEI DIR. SOLLTE SICH
     DAS PROGRAMM ALS FEHLERHAFT ERWEISEN, LIEGEN SéMTLICHE KOSTEN FöR
     NOTWENDIGE SERVICELEISTUNGEN, REPARATUR ODER KORREKTUR ALLEIN BEI DIR.

     Oder, in knapperen Worten:

     Wenn es gut ist, bin ich verantwortlich.
     Wenn es schlecht lÑuft, liegt der Fehler allein bei Dir ;-)

     Es wird die Erlaubnis eingerÑumt, dieses Programm kostenfrei
     weiterzuverteilen, vorausgesetzt, es wird als vollstÑndiges Archiv mit
     unverÑndertem Inhalt und ohne jeden Profit, der Åber den Preis des zum
     Weitergeben benîtigten Mediums hinausginge verteilt. Ausnahme zur obigen
     Regel: es kann in Freeware- oder Shareware Sammlungen auf CD-ROM erscheinen
     genauso wie auf CD-ROMs, die Zeitschriften beigelegt sind.

     Alle erwÑhnten Markenzeichen sind Eigentum der jeweiligen Besitzer und so
     weiter....

AUTORIN

     Daniela Engert
     Internet: "Daniela Engert" <dani@ngrt.de>

SCHLUSSWORT

     VorschlÑge und Fehlerberichte sind immer willkommen. Allerdings ...
     Fehlerberichte sind vielleicht nicht *ganz* so willkommen ....;)

